/**
 * Farbmischungen und Farbpaletten
 * 
 * Diese Datei implementiert moderne Farbfunktionen mit CSS color-mix(), um dynamische
 * Farbpaletten und Farbvariationen zu erzeugen. Anstatt statische Farbwerte zu verwenden,
 * werden Farbtöne programmatisch aus Basisfarben abgeleitet.
 * 
 * Hauptfunktionen:
 * - Generierung von Farbverläufen für primäre, sekundäre und Akzentfarben
 * - Semantische Farbvariablen für Textfarben, Links, Hintergründe usw.
 * - Themenvarianten (dunkel, hoher Kontrast)
 * - Komponentenspezifische Farbdefinitionen mit color-mix
 * - Fallbacks für Browser ohne color-mix-Unterstützung
 * 
 * @hinweis Diese Datei wird nach colors.css geladen und transformiert die dortigen Basisfarben
 * @technisch Diese Datei nutzt die CSS color-mix() Funktion, die in modernen Browsern unterstützt wird.
 */

/* 
 * Moderne Farbfunktionen mit color-mix
 */

@layer color-mix {
  /* Grundlegende Farbvariablen aus Design Tokens */
  :root {
    /* Primäre Farbpalette Verläufe durch color-mix */
    --color-primary-50: color-mix(in srgb, var(--color-primary-500) 5%, white);
    --color-primary-100: color-mix(in srgb, var(--color-primary-500) 10%, white);
    --color-primary-200: color-mix(in srgb, var(--color-primary-500) 20%, white);
    --color-primary-300: color-mix(in srgb, var(--color-primary-500) 30%, white);
    --color-primary-400: color-mix(in srgb, var(--color-primary-500) 40%, white);

    /* --color-primary-500 als Basis wird in theme-Dateien definiert */
    --color-primary-600: color-mix(in srgb, var(--color-primary-500) 80%, black);
    --color-primary-700: color-mix(in srgb, var(--color-primary-500) 70%, black);
    --color-primary-800: color-mix(in srgb, var(--color-primary-500) 60%, black);
    --color-primary-900: color-mix(in srgb, var(--color-primary-500) 50%, black);

    /* Sekundäre Farbpalette Verläufe durch color-mix */
    --color-secondary-50: color-mix(in srgb, var(--color-secondary-500) 5%, white);
    --color-secondary-100: color-mix(in srgb, var(--color-secondary-500) 10%, white);
    --color-secondary-200: color-mix(in srgb, var(--color-secondary-500) 20%, white);
    --color-secondary-300: color-mix(in srgb, var(--color-secondary-500) 30%, white);
    --color-secondary-400: color-mix(in srgb, var(--color-secondary-500) 40%, white);

    /* --color-secondary-500 als Basis wird in theme-Dateien definiert */
    --color-secondary-600: color-mix(in srgb, var(--color-secondary-500) 80%, black);
    --color-secondary-700: color-mix(in srgb, var(--color-secondary-500) 70%, black);
    --color-secondary-800: color-mix(in srgb, var(--color-secondary-500) 60%, black);
    --color-secondary-900: color-mix(in srgb, var(--color-secondary-500) 50%, black);

    /* Akzent Farbpalette Verläufe durch color-mix */
    --color-accent-50: color-mix(in srgb, var(--color-accent-500) 5%, white);
    --color-accent-100: color-mix(in srgb, var(--color-accent-500) 10%, white);
    --color-accent-200: color-mix(in srgb, var(--color-accent-500) 20%, white);
    --color-accent-300: color-mix(in srgb, var(--color-accent-500) 30%, white);
    --color-accent-400: color-mix(in srgb, var(--color-accent-500) 40%, white);

    /* --color-accent-500 als Basis wird in theme-Dateien definiert */
    --color-accent-600: color-mix(in srgb, var(--color-accent-500) 80%, black);
    --color-accent-700: color-mix(in srgb, var(--color-accent-500) 70%, black);
    --color-accent-800: color-mix(in srgb, var(--color-accent-500) 60%, black);
    --color-accent-900: color-mix(in srgb, var(--color-accent-500) 50%, black);

    /* Oberflächenfarben durch color-mix */
    --color-surface-50: color-mix(in srgb, var(--color-surface-500) 5%, white);
    --color-surface-100: color-mix(in srgb, var(--color-surface-500) 10%, white);
    --color-surface-200: color-mix(in srgb, var(--color-surface-500) 20%, white);
    --color-surface-300: color-mix(in srgb, var(--color-surface-500) 30%, white);
    --color-surface-400: color-mix(in srgb, var(--color-surface-500) 40%, white);

    /* --color-surface-500 als Basis wird in theme-Dateien definiert */
    --color-surface-600: color-mix(in srgb, var(--color-surface-500) 80%, black);
    --color-surface-700: color-mix(in srgb, var(--color-surface-500) 70%, black);
    --color-surface-800: color-mix(in srgb, var(--color-surface-500) 60%, black);
    --color-surface-900: color-mix(in srgb, var(--color-surface-500) 50%, black);

    /* Statusfarben durch color-mix */
    --color-success-50: color-mix(in srgb, var(--color-success) 5%, white);
    --color-success-100: color-mix(in srgb, var(--color-success) 10%, white);
    --color-success-200: color-mix(in srgb, var(--color-success) 20%, white);
    --color-success-300: color-mix(in srgb, var(--color-success) 30%, white);
    --color-success-400: color-mix(in srgb, var(--color-success) 40%, white);

    /* --color-success als Basis wird in theme-Dateien definiert */
    --color-success-600: color-mix(in srgb, var(--color-success) 80%, black);
    --color-success-700: color-mix(in srgb, var(--color-success) 70%, black);
    --color-success-800: color-mix(in srgb, var(--color-success) 60%, black);
    --color-success-900: color-mix(in srgb, var(--color-success) 50%, black);
    --color-error-50: color-mix(in srgb, var(--color-error) 5%, white);
    --color-error-100: color-mix(in srgb, var(--color-error) 10%, white);
    --color-error-200: color-mix(in srgb, var(--color-error) 20%, white);
    --color-error-300: color-mix(in srgb, var(--color-error) 30%, white);
    --color-error-400: color-mix(in srgb, var(--color-error) 40%, white);

    /* --color-error als Basis wird in theme-Dateien definiert */
    --color-error-600: color-mix(in srgb, var(--color-error) 80%, black);
    --color-error-700: color-mix(in srgb, var(--color-error) 70%, black);
    --color-error-800: color-mix(in srgb, var(--color-error) 60%, black);
    --color-error-900: color-mix(in srgb, var(--color-error) 50%, black);
    --color-warning-50: color-mix(in srgb, var(--color-warning) 5%, white);
    --color-warning-100: color-mix(in srgb, var(--color-warning) 10%, white);
    --color-warning-200: color-mix(in srgb, var(--color-warning) 20%, white);
    --color-warning-300: color-mix(in srgb, var(--color-warning) 30%, white);
    --color-warning-400: color-mix(in srgb, var(--color-warning) 40%, white);

    /* --color-warning als Basis wird in theme-Dateien definiert */
    --color-warning-600: color-mix(in srgb, var(--color-warning) 80%, black);
    --color-warning-700: color-mix(in srgb, var(--color-warning) 70%, black);
    --color-warning-800: color-mix(in srgb, var(--color-warning) 60%, black);
    --color-warning-900: color-mix(in srgb, var(--color-warning) 50%, black);
    --color-info-50: color-mix(in srgb, var(--color-info) 5%, white);
    --color-info-100: color-mix(in srgb, var(--color-info) 10%, white);
    --color-info-200: color-mix(in srgb, var(--color-info) 20%, white);
    --color-info-300: color-mix(in srgb, var(--color-info) 30%, white);
    --color-info-400: color-mix(in srgb, var(--color-info) 40%, white);

    /* --color-info als Basis wird in theme-Dateien definiert */
    --color-info-600: color-mix(in srgb, var(--color-info) 80%, black);
    --color-info-700: color-mix(in srgb, var(--color-info) 70%, black);
    --color-info-800: color-mix(in srgb, var(--color-info) 60%, black);
    --color-info-900: color-mix(in srgb, var(--color-info) 50%, black);
  }

  /* Farbschema-Variablen */
  :root {
    /* Semantische Farben */
    --text-color: var(--color-surface-900);
    --text-color-light: var(--color-surface-600);
    --link-color: color-mix(in srgb, var(--color-primary-700) 90%, var(--color-accent-500) 10%);
    --link-hover-color: color-mix(in srgb, var(--color-primary-500) 80%, var(--color-accent-500) 20%);
    
    /* Hintergrundfarben */
    --background-color: var(--color-surface-50);
    --subtle-background: color-mix(in srgb, var(--color-surface-100) 80%, var(--color-primary-50) 20%);
    
    /* Kontrastfarben für Barrierefreiheit */
    --high-contrast-text: var(--color-surface-900);
    --medium-contrast-text: var(--color-surface-700);
    --low-contrast-text: var(--color-surface-600);
    
    /* Buttonfarben */
    --button-primary-bg: var(--color-primary-500);
    --button-primary-text: white;
    --button-primary-hover: color-mix(in srgb, var(--color-primary-500) 90%, black);
    --button-secondary-bg: color-mix(in srgb, var(--color-secondary-500) 15%, white);
    --button-secondary-text: var(--color-secondary-900);
    --button-secondary-hover: color-mix(in srgb, var(--color-secondary-500) 25%, white);
    --button-accent-bg: var(--color-accent-500);
    --button-accent-text: white;
    --button-accent-hover: color-mix(in srgb, var(--color-accent-500) 90%, black);
    
    /* Randfarben */
    --border-light: color-mix(in srgb, var(--color-surface-500) 20%, white);
    --border-medium: color-mix(in srgb, var(--color-surface-500) 40%, white);
    --border-dark: color-mix(in srgb, var(--color-surface-500) 60%, white);
    
    /* Fokuseffekte */
    --focus-ring-color: color-mix(in srgb, var(--color-primary-500) 50%, transparent);
    
    /* Schattenmischungen */
    --shadow-color-light: color-mix(in srgb, var(--color-surface-900) 10%, transparent);
    --shadow-color-medium: color-mix(in srgb, var(--color-surface-900) 15%, transparent);
    --shadow-color-dark: color-mix(in srgb, var(--color-surface-900) 25%, transparent);
    
    /* Zusätzliche Oberflächenfarben aus theme-base.css */
    --color-surface-primary: color-mix(in oklab, var(--color-primary-500) 5%, white);
    --color-surface-secondary: color-mix(in oklab, var(--color-secondary-500) 5%, white);
    --color-surface-accent: color-mix(in oklab, var(--color-accent-500) 5%, white);
    
    /* Zusätzliche Status-Hintergrundfarben */
    --color-success-bg: color-mix(in oklab, var(--color-success) 10%, white);
    --color-error-bg: color-mix(in oklab, var(--color-error) 10%, white);
    --color-warning-bg: color-mix(in oklab, var(--color-warning) 10%, white);
    --color-info-bg: color-mix(in oklab, var(--color-info) 10%, white);
  }

  /* Themenvarianten anwenden */
  .theme-dark {
    --text-color: var(--color-surface-50);
    --text-color-light: var(--color-surface-300);
    --background-color: var(--color-surface-900);
    --subtle-background: color-mix(in srgb, var(--color-surface-800) 80%, var(--color-primary-900) 20%);
    --border-light: color-mix(in srgb, var(--color-surface-500) 40%, black);
    --border-medium: color-mix(in srgb, var(--color-surface-500) 60%, black);
    --border-dark: color-mix(in srgb, var(--color-surface-500) 80%, black);
    --high-contrast-text: var(--color-surface-50);
    --medium-contrast-text: var(--color-surface-200);
    --low-contrast-text: var(--color-surface-300);
    --focus-ring-color: color-mix(in srgb, var(--color-primary-500) 70%, transparent);
    --shadow-color-light: color-mix(in srgb, black 20%, transparent);
    --shadow-color-medium: color-mix(in srgb, black 30%, transparent);
    --shadow-color-dark: color-mix(in srgb, black 40%, transparent);
  }

  .theme-contrast {
    --text-color: black;
    --text-color-light: color-mix(in srgb, black 75%, transparent);
    --background-color: white;
    --link-color: var(--color-primary-900);
    --link-hover-color: black;
    --button-primary-bg: black;
    --button-primary-text: white;
    --button-primary-hover: color-mix(in srgb, black 90%, var(--color-primary-500));
    --button-secondary-bg: var(--color-surface-300);
    --button-secondary-text: black;
    --border-light: black;
    --border-medium: black;
    --border-dark: black;
    --focus-ring-color: var(--color-primary-500);
  }

  /* Fallback für Browser ohne color-mix Support */
  @supports not (color: color-mix(in srgb, red, blue)) {
    :root {
      --color-primary-light: var(--color-primary-300, #a5b4fc);
      --color-primary-lighter: var(--color-primary-200, #c7d2fe);
      --color-primary-lightest: var(--color-primary-100, #e0e7ff);
      --color-primary-dark: var(--color-primary-700, #4338ca);
      --color-primary-darker: var(--color-primary-800, #3730a3);
      --color-secondary-light: var(--color-secondary-300, #cbd5e1);
      --color-secondary-lighter: var(--color-secondary-200, #e2e8f0);
      --color-secondary-lightest: var(--color-secondary-100, #f1f5f9);
      --color-secondary-dark: var(--color-secondary-700, #334155);
      --color-secondary-darker: var(--color-secondary-800, #1e293b);
      --color-accent-light: var(--color-accent-300, #fcd34d);
      --color-accent-lighter: var(--color-accent-200, #fde68a);
      --color-accent-lightest: var(--color-accent-100, #fef3c7);
      --color-accent-dark: var(--color-accent-700, #b45309);
      --color-accent-darker: var(--color-accent-800, #92400e);
      --color-focus-ring: rgb(var(--color-primary-rgb, 99, 102, 241), 0.5);
      --color-surface-primary: rgb(var(--color-primary-rgb, 99, 102, 241), 0.05);
      --color-surface-secondary: rgb(var(--color-secondary-rgb, 100, 116, 139), 0.05);
      --color-surface-accent: rgb(var(--color-accent-rgb, 245, 158, 11), 0.05);
    }
  }

  /* Anwendung der neuen Farbmischungen in Komponenten */
  
  /* Buttons mit color-mix */
  .btn-primary {
    background-color: var(--button-primary-bg);
    color: var(--button-primary-text);
    border: 1px solid color-mix(in srgb, var(--button-primary-bg) 70%, black);
  }

  .btn-primary:hover {
    background-color: var(--button-primary-hover);
  }

  .btn-secondary {
    background-color: var(--button-secondary-bg);
    color: var(--button-secondary-text);
    border: 1px solid color-mix(in srgb, var(--button-secondary-bg) 90%, var(--color-secondary-500));
  }

  .btn-secondary:hover {
    background-color: var(--button-secondary-hover);
  }

  .btn-accent {
    background-color: var(--button-accent-bg);
    color: var(--button-accent-text);
    border: 1px solid color-mix(in srgb, var(--button-accent-bg) 70%, black);
  }

  .btn-accent:hover {
    background-color: var(--button-accent-hover);
  }

  /* Karten und Container mit color-mix */
  .card {
    background-color: white;
    border: 1px solid var(--border-light);
    box-shadow: 0 2px 4px var(--shadow-color-light), 0 4px 8px var(--shadow-color-medium);
  }

  .card-hover:hover {
    border-color: var(--border-medium);
    box-shadow: 0 4px 8px var(--shadow-color-medium), 0 8px 16px var(--shadow-color-dark);
  }

  /* Überschriften mit color-mix */
  .heading-accent {
    color: var(--text-color);
    border-bottom: 2px solid color-mix(in srgb, var(--color-primary-500) 70%, var(--color-accent-500) 30%);
  }

  /* Textboxen mit color-mix */
  .text-box {
    background-color: color-mix(in srgb, var(--background-color) 95%, var(--color-primary-100) 5%);
    border: 1px solid var(--border-light);
  }

  .text-box:focus-within {
    background-color: white;
    border-color: var(--color-primary-400);
    box-shadow: 0 0 0 3px var(--focus-ring-color);
  }

  /* Alerts/Benachrichtigungen mit color-mix */
  .alert-success {
    background-color: color-mix(in srgb, var(--color-success-50) 80%, white);
    border-left: 4px solid var(--color-success);
    color: color-mix(in srgb, var(--color-success-900) 90%, black);
  }

  .alert-error {
    background-color: color-mix(in srgb, var(--color-error-50) 80%, white);
    border-left: 4px solid var(--color-error);
    color: color-mix(in srgb, var(--color-error-900) 90%, black);
  }

  .alert-warning {
    background-color: color-mix(in srgb, var(--color-warning-50) 80%, white);
    border-left: 4px solid var(--color-warning);
    color: color-mix(in srgb, var(--color-warning-900) 90%, black);
  }

  .alert-info {
    background-color: color-mix(in srgb, var(--color-info-50) 80%, white);
    border-left: 4px solid var(--color-info);
    color: color-mix(in srgb, var(--color-info-900) 90%, black);
  }

  /* Badges mit color-mix */
  .badge-primary {
    background-color: color-mix(in srgb, var(--color-primary-100) 80%, var(--color-primary-500) 20%);
    color: var(--color-primary-900);
  }

  .badge-secondary {
    background-color: color-mix(in srgb, var(--color-secondary-100) 80%, var(--color-secondary-500) 20%);
    color: var(--color-secondary-900);
  }

  .badge-accent {
    background-color: color-mix(in srgb, var(--color-accent-100) 80%, var(--color-accent-500) 20%);
    color: var(--color-accent-900);
  }

  /* Navigation mit color-mix */
  .nav-item {
    color: var(--text-color);
  }

  .nav-item:hover {
    color: var(--link-hover-color);
    background-color: color-mix(in srgb, transparent 95%, var(--color-primary-200) 5%);
  }

  .nav-item.active {
    color: var(--color-primary-700);
    border-bottom: 2px solid var(--color-primary-500);
    background-color: color-mix(in srgb, transparent 90%, var(--color-primary-100) 10%);
  }

  /* Fortschrittsbalken mit color-mix */
  .progress-bar {
    background-color: color-mix(in srgb, var(--color-surface-200) 90%, var(--color-surface-300) 10%);
    height: 0.5rem;
    border-radius: 999px;
    overflow: hidden;
  }

  .progress-bar-fill {
    height: 100%;
    background: linear-gradient(
      to right,
      var(--color-primary-500),
      color-mix(in srgb, var(--color-primary-500) 70%, var(--color-accent-500) 30%)
    );
  }

  /* Toggle-Switch mit color-mix */
  .switch {
    position: relative;
    display: inline-block;
    width: 40px;
    height: 24px;
  }

  .switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .switch-slider {
    position: absolute;
    cursor: pointer;
    inset: 0;
    background-color: color-mix(in srgb, var(--color-surface-400) 90%, var(--color-surface-500) 10%);
    transition: .4s;
    border-radius: 24px;
  }

  .switch-slider::before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
  }

  input:checked + .switch-slider {
    background: linear-gradient(
      to right,
      var(--color-primary-600),
      var(--color-primary-500)
    );
  }

  input:focus + .switch-slider {
    box-shadow: 0 0 0 2px var(--focus-ring-color);
  }

  input:checked + .switch-slider::before {
    transform: translateX(16px);
  }

  /* Tooltip mit color-mix */
  .tooltip {
    --tooltip-bg: color-mix(in srgb, var(--color-surface-900) 90%, var(--color-primary-500) 10%);
    --tooltip-text: white;
    
    position: relative;
    display: inline-block;
  }

  .tooltip-content {
    visibility: hidden;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 50%;
    transform: translateX(-50%);
    background-color: var(--tooltip-bg);
    color: var(--tooltip-text);
    text-align: center;
    padding: 0.5rem 1rem;
    border-radius: 0.25rem;
    white-space: nowrap;
    box-shadow: 0 2px 5px var(--shadow-color-dark);
  }

  .tooltip-content::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: var(--tooltip-bg) transparent transparent transparent;
  }

  .tooltip:hover .tooltip-content {
    visibility: visible;
  }

  /* Farbverlauf und Text-Effekte */
  .gradient-text {
    background: linear-gradient(
      45deg, 
      var(--color-primary-500),
      var(--color-accent-500)
    );
    background-clip: text;
    color: transparent;
  }

  .overlay-card {
    position: relative;
    overflow: hidden;
  }

  .overlay-card::before {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(
      to bottom,
      transparent,
      color-mix(in srgb, var(--color-primary-900) 70%, black)
    );
    opacity: 0.7;
  }

  /* Farbanpassungen für die Barrierefreiheit */
  @media (prefers-color-scheme: dark) {
    :root:not(.theme-light, .theme-contrast) {
      --text-color: var(--color-surface-50);
      --text-color-light: var(--color-surface-300);
      --background-color: var(--color-surface-900);
      --subtle-background: color-mix(in srgb, var(--color-surface-800) 80%, var(--color-primary-900) 20%);
      --border-light: color-mix(in srgb, var(--color-surface-500) 40%, black);
      --border-medium: color-mix(in srgb, var(--color-surface-500) 60%, black);
      --border-dark: color-mix(in srgb, var(--color-surface-500) 80%, black);
      --high-contrast-text: var(--color-surface-50);
      --medium-contrast-text: var(--color-surface-200);
      --low-contrast-text: var(--color-surface-300);
      --shadow-color-light: color-mix(in srgb, black 20%, transparent);
      --shadow-color-medium: color-mix(in srgb, black 30%, transparent);
      --shadow-color-dark: color-mix(in srgb, black 40%, transparent);
    }
  }

  @container root (prefers-reduced-motion) {
    .color-transition,
    .color-cycle,
    .color-pulse,
    .color-fade,
    .color-shift,
    .color-breathing,
    .gradient-cycle,
    .gradient-flow,
    .gradient-morph,
    .gradient-pulse,
    .theme-transition {
      transition: none !important;
      animation: none !important;
    }
  }

  /* Dunkles Farbschema */
  @container root (prefers-color-scheme: dark) {
    :root {
      --color-mix-base: 0.2;
      --color-mix-primary: 0.3;
      --color-mix-secondary: 0.3;
      --color-mix-tertiary: 0.4;
      --color-mix-accent: 0.5;
      
      /* Angepasste Mischverhältnisse für dunkles Theme */
      --mix-light-value: 0.2;
      --mix-dark-value: 0.6;
      --mix-bw-value: 0.1;
    }
    
    .color-mix-reverse {
      --color-mix-mode: difference;
    }
    
    .mix-overlay {
      --color-blend-mode: overlay;
    }
  }
} 